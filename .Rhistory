install.packages('tinytex')
tinytex::install_tinytex()
install.packages(c('openintro','devtools','tidyverse', 'ggplot2',
'psych','reshape2','knitr','markdown','shiny','R.rsp',
'fivethirtyeight'))
devtools::install_github("jbryer/DATA606")
devtools::install_github('jbryer/VisualStats')
hfi %>%
summarise(cor(pf_expression_control, pf_score, use = "complete.obs"))
# Chunk 1: global_options
knitr::opts_chunk$set(eval = TRUE, message = FALSE, warning = FALSE)
# Chunk 2: load-packages
library(tidyverse)
library(openintro)
data('hfi', package='openintro')
# Chunk 3: dataset-dimensions
dim(hfi)
# Chunk 4: scatterplot-pf
ggplot(data = hfi, aes(x = pf_expression_control, y = pf_score)) +
geom_point() +
labs(title = "Personal Freedom Score vs. Expression Control",
x = "Expression Control (0 = most control)",
y = "Personal Freedom Score") +
theme_minimal()
# Chunk 1: global_options
knitr::opts_chunk$set(eval = TRUE, message = FALSE, warning = FALSE)
# Chunk 2: load-packages
library(tidyverse)
library(openintro)
data('hfi', package='openintro')
# Chunk 3: dataset-dimensions
dim(hfi)
# Chunk 4: scatterplot-pf
ggplot(data = hfi, aes(x = pf_expression_control, y = pf_score)) +
geom_point() +
labs(title = "Personal Freedom Score vs. Expression Control",
x = "Expression Control (0 = most control)",
y = "Personal Freedom Score") +
theme_minimal()
# This will only work interactively (i.e. will not show in the knitted document)
hfi <- hfi %>% filter(complete.cases(pf_expression_control, pf_score))
DATA606::plot_ss(x = hfi$pf_expression_control, y = hfi$pf_score)
hfi %>%
summarise(cor(pf_expression_control, pf_score, use = "complete.obs"))
hfi %>%
summarise(cor(pf_expression_control, pf_score, use = "complete.obs"))
ggplot(data = hfi, aes(x = pf_expression_control, y = pf_score)) +
geom_point() +
labs(title = "Personal Freedom Score vs. Expression Control",
x = "Expression Control (0 = most control)",
y = "Personal Freedom Score") +
theme_minimal()
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
m1 <- lm(pf_score ~ pf_expression_control, data = hfi)
m1 <- lm(pf_score ~ pf_expression_control, data = hfi)
summary(m1)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
set.seed(1234)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
set.seed(1234)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
set.seed(1234)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
set.seed(1234)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
DATA606::plot_ss(x = hfi$pf_expression_control, y = hfi$pf_score, showSquares = TRUE)
DATA606::plot_ss(x = hfi$pf_expression_control, y = hfi$pf_score, showSquares = TRUE)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
set.seed(1234)
hfi_small <- hfi %>%
filter(complete.cases(pf_expression_control, pf_score)) %>%
sample_n(30)
DATA606::plot_ss(x = hfi_small$pf_expression_control, y = hfi_small$pf_score)
m1 <- lm(pf_score ~ pf_expression_control, data = hfi)
summary(m1)
m2 <- lm(hf_score ~ pf_expression_control, data = hfi)
summary(m2)
summary(m1)
summary(m1)
ggplot(data = hfi, aes(x = pf_expression_control, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE)
# Make prediction for pf_expression_control = 6.7
predicted_pf_score <- 4.61707 + 0.49143 * 6.7
cat("Predicted personal freedom score:", round(predicted_pf_score, 4), "\n")
# Find the actual country with pf_expression_control closest to 6.7
hfi_clean <- hfi %>% filter(complete.cases(pf_expression_control, pf_score))
closest_country <- hfi_clean %>%
mutate(distance = abs(pf_expression_control - 6.7)) %>%
arrange(distance) %>%
slice(1)
cat("\nClosest observation in data:\n")
cat("Expression Control:", round(closest_country$pf_expression_control, 2), "\n")
cat("Personal Freedom Score:", round(closest_country$pf_score, 2), "\n")
# Calculate residual
residual <- closest_country$pf_score - predicted_pf_score
cat("\nActual personal freedom score:", round(closest_country$pf_score, 4), "\n")
cat("Predicted personal freedom score:", round(predicted_pf_score, 4), "\n")
cat("Residual:", round(residual, 4), "\n")
if (residual > 0) {
cat("This is an UNDERESTIMATE by", round(abs(residual), 4), "points\n")
} else {
cat("This is an OVERESTIMATE by", round(abs(residual), 4), "points\n")
}
predicted_pf_score <- 4.61707 + 0.49143 * 6.7
predicted_pf_score
# Find the actual country with pf_expression_control closest to 6.7
hfi_clean <- hfi %>% filter(complete.cases(pf_expression_control, pf_score))
closest_country <- hfi_clean %>%
mutate(distance = abs(pf_expression_control - 6.7)) %>%
arrange(distance) %>%
slice(1)
# Calculate residual
residual <- closest_country$pf_score - predicted_pf_score
cat("\nActual personal freedom score:", round(closest_country$pf_score, 4), "\n")
cat("Predicted personal freedom score:", round(predicted_pf_score, 4), "\n")
cat("Residual:", round(residual, 4), "\n")
if (residual > 0) {
cat("This is an UNDERESTIMATE by", round(abs(residual), 4), "points\n")
} else {
cat("This is an OVERESTIMATE by", round(abs(residual), 4), "points\n")
}
ggplot(data = m1, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
xlab("Fitted values") +
ylab("Residuals")
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 25) +
xlab("Residuals")
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 25) +
xlab("Residuals")
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 0.25) +
xlab("Residuals") +
ggtitle("Histogram of Residuals") +
theme_minimal()
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 0.25) +
xlab("Residuals") +
ggtitle("Histogram of Residuals") +
theme_minimal()
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 0.25) +
xlab("Residuals") +
ggtitle("Histogram of Residuals")
ggplot(data = m1, aes(x = .resid))
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 25) +
xlab("Residuals")
ggplot(data = m1, aes(x = .resid)) +
geom_histogram +
xlab("Residuals")
ggplot(data = m1, aes(x = .resid)) +
geom_histogram(binwidth = 0.25) +
xlab("Residuals")
http://127.0.0.1:45612/graphics/d157a362-f591-48df-b03f-2d61b163b521.png
ggplot(data = m1, aes(sample = .resid)) +
stat_qq() +
stat_qq_line() +
ggtitle("Normal Q-Q Plot of Residuals") +
theme_minimal()
# Explore relationship between Economic Freedom and Personal Freedom
ggplot(data = hfi, aes(x = ef_score, y = pf_score)) +
geom_point() +
labs(title = "Personal Freedom vs. Economic Freedom",
x = "Economic Freedom Score",
y = "Personal Freedom Score") +
theme_minimal()
# Fit linear model
m3 <- lm(pf_score ~ ef_score, data = hfi)
summary(m3)
# Add regression line
ggplot(data = hfi, aes(x = ef_score, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE) +
labs(title = "Personal Freedom vs. Economic Freedom with Regression Line",
x = "Economic Freedom Score",
y = "Personal Freedom Score") +
theme_minimal()
# Explore relationship between Religion Freedom and Personal Freedom
# This might be surprising - how does religious freedom relate to overall personal freedom?
ggplot(data = hfi, aes(x = pf_religion, y = pf_score)) +
geom_point() +
labs(title = "Personal Freedom vs. Religious Freedom",
x = "Religious Freedom Score",
y = "Personal Freedom Score") +
theme_minimal()
# Fit linear model
m_surprise <- lm(pf_score ~ pf_religion, data = hfi)
summary(m_surprise)
# Display model diagnostics
# 1. Residuals vs Fitted
p1 <- ggplot(data = m_surprise, aes(x = .fitted, y = .resid)) +
geom_point() +
geom_hline(yintercept = 0, linetype = "dashed") +
xlab("Fitted values") +
ylab("Residuals") +
ggtitle("Residuals vs. Fitted Values") +
theme_minimal()
# 2. Histogram of Residuals
p2 <- ggplot(data = m_surprise, aes(x = .resid)) +
geom_histogram(binwidth = 0.3) +
xlab("Residuals") +
ggtitle("Histogram of Residuals") +
theme_minimal()
# 3. Q-Q Plot
p3 <- ggplot(data = m_surprise, aes(sample = .resid)) +
stat_qq() +
stat_qq_line() +
ggtitle("Normal Q-Q Plot") +
theme_minimal()
# 4. Scatterplot with regression line
p4 <- ggplot(data = hfi, aes(x = pf_religion, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE) +
ggtitle("Scatterplot with Regression Line") +
theme_minimal()
# Display all plots
gridExtra::grid.arrange(p1, p2, p3, p4, ncol = 2)
# Explore relationship between Religion Freedom and Personal Freedom
# This might be surprising - how does religious freedom relate to overall personal freedom?
# 4. Scatterplot with regression line
p4 <- ggplot(data = hfi, aes(x = pf_religion, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE) +
ggtitle("Scatterplot with Regression Line") +
theme_minimal()
# Explore relationship between Religion Freedom and Personal Freedom
# This might be surprising - how does religious freedom relate to overall personal freedom?
# 4. Scatterplot with regression line
p4 <- ggplot(data = hfi, aes(x = pf_religion, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE) +
ggtitle("Scatterplot with Regression Line") +
theme_minimal()
# Explore relationship between Religion Freedom and Personal Freedom
# This might be surprising - how does religious freedom relate to overall personal freedom?
# 4. Scatterplot with regression line
ggplot(data = hfi, aes(x = pf_religion, y = pf_score)) +
geom_point() +
stat_smooth(method = "lm", se = FALSE) +
ggtitle("Scatterplot with Regression Line") +
theme_minimal()
shiny::runApp('Documents/yeshiva/computationalMaths/projects')
